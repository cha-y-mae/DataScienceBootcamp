1. Pull total number of orders that were completed on 18th March 2023

SELECT COUNT(*) AS total_completed_orders
FROM orders
WHERE completion_date = '2023-03-18';

2. Pull total number of orders that were completed on 18th March 2023 with the first name ‘John’ and last name ‘Doe’

SELECT COUNT(*) AS total_completed_orders
FROM orders
WHERE completion_date = '2023-03-18' AND first_name = 'John' AND last_name = 'Doe';

3. Pull total number of customers that purchased in January 2023 and the average amount spend per customer

SELECT COUNT(DISTINCT c.customer_id) AS total_customers, AVG(p.amount) AS average_amount_per_customer
FROM customers c JOIN purchases p ON c.customer_id = p.customer_id WHERE p.purchase_date >= '2023-01-01' AND p.purchase_date <= '2023-01-31';


4. Pull the departments that generated less than $600 in 2022

SELECT department FROM sales WHERE YEAR(sale_date) = 2022 GROUP BY department HAVING SUM(revenue) < 600;

5. What is the most and least revenue we have generated by an order

--Most revenue

SELECT MAX(revenue) AS most_revenue FROM orders;

--Least revenue 

SELECT MIN(revenue) AS least_revenue FROM orders;

6. What were the orders that were purchased in our most lucrative order

SELECT order_id FROM orders ORDER BY revenue DESC LIMIT 1;
SELECT * FROM orders WHERE order_id = (SELECT order_id FROM orders ORDER BY revenue DESC LIMIT 1);
